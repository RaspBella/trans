<!DOCTYPE html>
<html>
  <head>
    <title>temp test tool</title>
    <link rel="stylesheet" href="crs.css">
  </head>
  <body>
    <div class="container">
      <label>CRS</label>
      <input type="text" id="code" minlength="3" maxlength="3"/>
      <button onclick="submit_code()">Submit CRS</button>
      <br><br>
      <label>Name</label>
      <input type="text" id="name"/>
      <button onclick="submit_name()">Submit Name</button>
    </div>
    <script type="module" src="crs.js"></script>
    <script>
      const SEP = "\n";
      const code = document.getElementById("code");
      const name = document.getElementById("name");
      const button = document.getElementById("button");

      function submit_code() {
        if (/^[a-zA-Z]{3}$/.test(code.value)) {
          const result = crs(code.value.toUpperCase());

          if (result) {
            code.value = code.value.toUpperCase();

            let has_sep = result.indexOf(SEP);

            if (has_sep === -1) {
              name.value = result;
            }

            else {
              name.value = result.slice(0, has_sep);
            }

            return;
          }
        }

        name.value = "";
      }

      function submit_name() {
        const result = src(name.value);

        if (result && result != "") {
          code.value = result;

          name.value = crs(code.value);

          return;
        }

        code.value = "";
      }

      code.addEventListener("keydown", (e) => {
        if (e.code === "Enter") {
          submit_code();
        }
      });
 
      name.addEventListener("keydown", (e) => {
        if (e.code === "Enter") {
          submit_name();
        }
      });
    </script>
  </body>
</html>
